{"version":3,"sources":["main.src.js"],"names":["global","demand","provide","definition","configure","pattern","/nucleus","/velocity","/prism/js","/prism/css","modules","/demand/handler/legacy","probe","Velocity","Prism","current","arrayPrototypeSlice","Array","prototype","slice","documentElement","document","regexMatchBasename","hash","window","location","viewport","getElementById","scrollTo","offsetTop","then","DomElement","DomElementAppear","ComponentIterator","functionDebounce","onResize","width","innerWidth","clientWidth","height","innerHeight","clientHeigh","dpr","Math","min","devicePixelRatio","i","section","sections","observe","updateImage","style","backgroundImage","image","replace","toFixed","iterator","title","marker","body","navigation","itemscope","itemtype","role","call","querySelectorAll","markers","on","event","index","setAttribute","details","priority","this","seek","self","preventDefault","stopPropagation","Snippet","parentNode","id","querySelector","textContent","getAttribute","href","itemprop","left","opacity","setContent","appendTo","auto","push","setData","insertBefore","element","duration","easing","delay"],"mappings":"CAAC,SAASA,EAAQC,EAAQC,GACzB,YAEA,SAASC,GAAWF,GAElBA,EACEG,WACAC,SACCC,WAAc,2CACdC,YAAc,iDACdC,YAAc,0CACdC,aAAc,2DAEfC,SACCC,0BACCJ,aACCK,MAAO,WACN,MAAOZ,GAAOa,WAGhBL,aACCI,MAAO,WACN,MAAOZ,GAAOc,WAOrB,IAKCC,GALGC,EAAsBC,MAAMC,UAAUC,MACzCC,EAAsBC,SAASD,gBAC/BE,EAAsB,iCACtBC,EAAsBC,OAAOC,SAASF,KACtCG,IAiQD,OA9PGH,KAASR,EAAUM,SAASM,eAAe,WAAaJ,EAAKJ,MAAM,MACrEnB,EAAO4B,SAAS,EAAGb,EAAQc,WAG5B5B,EAAO,uBAAwB,8BAA+B,8BAA+B,8BAA8B6B,KAC1H,SAASC,EAAYC,EAAkBC,EAAmBC,GAQzD,QAASC,KAKR,IAJAT,EAASU,MAASpC,EAAOqC,YAAcjB,EAAgBkB,YACvDZ,EAASa,OAASvC,EAAOwC,aAAepB,EAAgBqB,YACxDf,EAASgB,IAASC,KAAKC,IAAI,EAAG5C,EAAO6C,kBAAoB,GAErDC,EAAI,EAAGC,EAAUC,EAASF,GAAIA,IAC9BC,EAAQE,SACVC,EAAYH,GAKf,QAASG,GAAYH,GACpBA,EAAQI,MAAMC,gBAAkB,OAASL,EAAQM,MAAMC,QAAQhC,EAAoB,MAAQI,EAASU,MAAQ,IAAMV,EAASa,OAAS,IAAiC,IAA1Bb,EAASgB,IAAIa,QAAQ,GAAY,OAAS,IApBtL,GAKCC,GAAUV,EAAGC,EAASU,EAAOC,EAL1BlC,EAAa,GAAIO,GAAW/B,GAC/B2D,EAAa,GAAI5B,GAAW,QAC5B6B,EAAa,GAAI7B,GAAW,WAAa8B,WAAW,EAAMC,SAAU,0CAA2CC,KAAM,eACrHf,EAAahC,EAAoBgD,KAAK3C,SAAS4C,iBAAiB,uDAChEC,IAkDD,KA/BAV,GAAW,GAAIvB,IACbkC,GAAG,mBAAoB,SAASC,GAChCpB,EAASQ,EAASa,OAAS,GAAGX,OAAOY,aAAa,gBAA2B,aAAVF,EAAuB,OAAS,WAGrGT,EACEQ,GAAG,SAAU,gDAAiD,SAASC,EAAOG,GACtD,IAArBA,EAAQC,WACVxE,EAAOyB,SAASF,KAAOkD,KAAKlD,KAC5BiC,EAASkB,KAAKD,KAAKJ,QAGpBnB,EAAYuB,MAEZA,KAAKxB,SAAU,IAEfkB,GAAG,YAAa,gDAAiD,iBAC1DM,MAAKxB,UAEZkB,GAAG,QAAS,oBAAqB,SAASC,GAC1C,GAAIO,GAAOF,IAEXL,GAAMQ,iBACNR,EAAMS,kBAEN5E,EAAO,aACL6B,KAAK,SAASgD,GACd,GAAIA,GAAQH,EAAKI,gBAIjBjC,EAAI,EAAGC,EAAUC,EAASF,GAAIA,IACjCvB,EAAiBwB,EAAQiC,GAAG7D,MAAM,GAClCsC,EAAiBpC,SAAS4D,cAAc,IAAMlC,EAAQiC,GAAK,0BAA0BE,YACrFnC,EAAQxB,KAASA,EACjBwB,EAAQsB,MAASvB,EACjBC,EAAQM,MAAShC,SAAS4D,cAAc,IAAMlC,EAAQiC,GAAK,uBAAuBG,aAAa,WAC/FpC,EAAQW,OAAS,GAAI3B,GAAW,SAAWqD,KAAM,IAAM7D,EAAM8D,SAAU,MAAO5B,MAAOA,IAAW6B,KAAM,OAAQC,QAAS,IACrHC,WAAW/B,GACXgC,SAAS7B,GAEXb,EAAQuB,aAAa,YAAa/C,GAElC,GAAIS,GAAiBe,GAAW2C,KAAM,IAEtCxB,EAAQyB,KAAK5C,EAAQW,OAGtBlC,GAAO2C,GAAG,2BAA4BjC,EAAiBC,IACvDA,IAEAqB,EAASoC,QAAQ5C,GACjBY,EAAWiC,aAAa,WAExB5F,EAAO,oBACL6B,KAAK,SAASjB,GACd,IAAIiC,EAAI,EAAGY,EAASQ,EAAQpB,GAAIA,IAC/BjC,EAAS6C,EAAOoC,SAAWR,KAAM,EAAGC,QAAS,IAAOQ,SAAU,IAAKC,OAAQ,cAAeC,MAAkB,IAAVnD,EAAI,KAGvGa,GACEQ,GAAG,QAAS,yDAA0D,SAASC,GAC/EA,EAAMQ,iBACNR,EAAMS,kBAENhE,EAASQ,SAAS4D,cAAc,eAAiBR,KAAKlD,KAAKJ,MAAM,GAAK,MAAO,UAAY4E,SAAU,IAAKC,OAAQ,0BAgK/G,EAGR9F,GAAU,UAAYC,IACrBsE,KAAMxE,OAAQC","file":"main.js","sourcesContent":["(function(global, demand, provide) {\n\t'use strict';\n\n\tfunction definition(demand) {\n\t\t// configure demand\n\t\t\tdemand\n\t\t\t\t.configure({\n\t\t\t\t\tpattern: {\n\t\t\t\t\t\t'/nucleus':   '//cdn.jsdelivr.net/qoopido.nucleus/1.0.0',\n\t\t\t\t\t\t'/velocity':  '//cdn.jsdelivr.net/velocity/1.2.3/velocity.min',\n\t\t\t\t\t\t'/prism/js':  '//cdn.jsdelivr.net/prism/1.2.0/prism.js',\n\t\t\t\t\t\t'/prism/css': '//cdn.jsdelivr.net/prism/1.2.0/themes/prism-okaidia.css'\n\t\t\t\t\t},\n\t\t\t\t\tmodules: {\n\t\t\t\t\t\t'/demand/handler/legacy': {\n\t\t\t\t\t\t\t'/velocity': {\n\t\t\t\t\t\t\t\tprobe: function() {\n\t\t\t\t\t\t\t\t\treturn global.Velocity;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'/prism/js': {\n\t\t\t\t\t\t\t\tprobe: function() {\n\t\t\t\t\t\t\t\t\treturn global.Prism;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\tvar arrayPrototypeSlice = Array.prototype.slice,\n\t\t\tdocumentElement     = document.documentElement,\n\t\t\tregexMatchBasename  = /(.+)\\.(jp(e?)g|hig|png|webp)$/i,\n\t\t\thash                = window.location.hash,\n\t\t\tviewport            = {},\n\t\t\tcurrent;\n\n\t\tif(hash && (current = document.getElementById('section-' + hash.slice(1)))) {\n\t\t\tglobal.scrollTo(0, current.offsetTop);\n\t\t}\n\n\t\tdemand('/nucleus/dom/element', '/nucleus/dom/element/appear', '/nucleus/component/iterator', '/nucleus/function/debounce').then(\n\t\t\tfunction(DomElement, DomElementAppear, ComponentIterator, functionDebounce) {\n\t\t\t\tvar window     = new DomElement(global),\n\t\t\t\t\tbody       = new DomElement('body'),\n\t\t\t\t\tnavigation = new DomElement('<nav />', { itemscope: true, itemtype: 'http://schema.org/SiteNavigationElement', role: 'navigation' }),\n\t\t\t\t\tsections   = arrayPrototypeSlice.call(document.querySelectorAll('main [itemtype=\"http://schema.org/WebPageElement\"]')),\n\t\t\t\t\tmarkers     = [],\n\t\t\t\t\titerator, i, section, title, marker;\n\n\t\t\t\tfunction onResize() {\n\t\t\t\t\tviewport.width  = global.innerWidth || documentElement.clientWidth;\n\t\t\t\t\tviewport.height = global.innerHeight || documentElement.clientHeigh;\n\t\t\t\t\tviewport.dpr    = Math.min(2, global.devicePixelRatio || 1);\n\n\t\t\t\t\tfor(i = 0; section = sections[i]; i++) {\n\t\t\t\t\t\tif(section.observe) {\n\t\t\t\t\t\t\tupdateImage(section);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction updateImage(section) {\n\t\t\t\t\tsection.style.backgroundImage = 'url(' + section.image.replace(regexMatchBasename, '$1.' + viewport.width + 'x' + viewport.height + '@' + (viewport.dpr.toFixed(2) * 100) + '.$2') + ')';\n\t\t\t\t}\n\n\t\t\t\titerator = new ComponentIterator()\n\t\t\t\t\t.on('preSeek postSeek', function(event) {\n\t\t\t\t\t\tsections[iterator.index || 0].marker.setAttribute('aria-selected', event === 'postSeek' ? 'true' : 'false');\n\t\t\t\t\t});\n\n\t\t\t\tbody\n\t\t\t\t\t.on('appear', '[itemtype=\"http://schema.org/WebPageElement\"]', function(event, details) {\n\t\t\t\t\t\tif(details.priority === 1) {\n\t\t\t\t\t\t\tglobal.location.hash = this.hash;\n\t\t\t\t\t\t\titerator.seek(this.index);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tupdateImage(this);\n\n\t\t\t\t\t\tthis.observe = true;\n\t\t\t\t\t})\n\t\t\t\t\t.on('disappear', '[itemtype=\"http://schema.org/WebPageElement\"]', function() {\n\t\t\t\t\t\tdelete this.observe;\n\t\t\t\t\t})\n\t\t\t\t\t.on('click', '[href=\"#snippet\"]', function(event) {\n\t\t\t\t\t\tvar self = this;\n\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\t\tdemand('./snippet')\n\t\t\t\t\t\t\t.then(function(Snippet) {\n\t\t\t\t\t\t\t\tnew Snippet(self.parentNode);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\tfor(i = 0; section = sections[i]; i++) {\n\t\t\t\t\thash           = section.id.slice(8);\n\t\t\t\t\ttitle          = document.querySelector('#' + section.id + ' [itemprop=\"headline\"]').textContent;\n\t\t\t\t\tsection.hash   = hash;\n\t\t\t\t\tsection.index  = i;\n\t\t\t\t\tsection.image  = document.querySelector('#' + section.id + ' [itemprop=\"image\"]').getAttribute('content'),\n\t\t\t\t\tsection.marker = new DomElement('<a />', { href: '#' + hash, itemprop: 'url', title: title }, { left: '48px', opacity: 0 })\n\t\t\t\t\t\t.setContent(title)\n\t\t\t\t\t\t.appendTo(navigation);\n\n\t\t\t\t\tsection.setAttribute('data-hash', hash);\n\n\t\t\t\t\tnew DomElementAppear(section, { auto: 2 });\n\n\t\t\t\t\tmarkers.push(section.marker);\n\t\t\t\t}\n\n\t\t\t\twindow.on('resize orientationchange', functionDebounce(onResize));\n\t\t\t\tonResize();\n\n\t\t\t\titerator.setData(sections);\n\t\t\t\tnavigation.insertBefore('#github');\n\n\t\t\t\tdemand('legacy!/velocity')\n\t\t\t\t\t.then(function(Velocity) {\n\t\t\t\t\t\tfor(i = 0; marker = markers[i]; i++) {\n\t\t\t\t\t\t\tVelocity(marker.element, { left: 0, opacity: 1 }, { duration: 100, easing: 'easeOutQuad', delay: (i + 10) * 50 });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbody\n\t\t\t\t\t\t\t.on('click', '[itemtype=\"http://schema.org/SiteNavigationElement\"] a', function(event) {\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\tevent.stopPropagation();\n\n\t\t\t\t\t\t\t\tVelocity(document.querySelector('[data-hash=\"' + this.hash.slice(1) + '\"]'), 'scroll', { duration: 600, easing: 'easeInOutCubic' });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t}\n\t\t);\n\n\t\t/**\n\t\t * further examples\n\t\t */\n\t\t/*\n\t\tdemand('/nucleus/url')\n\t\t\t.then(\n\t\t\t\tfunction(Url) {\n\t\t\t\t\tvar test = new Url('http://www.qoopido.com/index.php?test=1#top');\n\n\t\t\t\t\ttest.searchParams.set('blubb', true);\n\t\t\t\t\ttest.searchParams.remove('test');\n\n\t\t\t\t\tconsole.log(test.href);\n\t\t\t\t}\n\t\t\t);\n\t\t*/\n\n\t\t/*\n\t\tdemand('/nucleus/component/sense')\n\t\t\t.then(\n\t\t\t\tfunction(componentSense) {\n\t\t\t\t\tvar sense1 = new componentSense('screen and (min-width: 600px)'),\n\t\t\t\t\t\tsense2 = new componentSense('screen and (min-width: 1000px)');\n\n\t\t\t\t\tconsole.log(sense1, sense2);\n\n\t\t\t\t\tsense1.on('match unmatch', function(event) {\n\t\t\t\t\t\tconsole.log('1', event);\n\t\t\t\t\t});\n\n\t\t\t\t\tsense2.on('match unmatch', function(event) {\n\t\t\t\t\t\tconsole.log('2', event);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t*/\n\n\t\t/*\n\t\tdemand('/nucleus/component/iterator')\n\t\t\t.then(\n\t\t\t\tfunction(componentIterator) {\n\t\t\t\t\tvar test = new componentIterator()\n\t\t\t\t\t\t.on('preSeek', function(event, args) {\n\t\t\t\t\t\t\tconsole.log('=>', event, this.index);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('postSeek', function(event, args, returnValue) {\n\t\t\t\t\t\t\tconsole.log('=>', event, this.index);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.setData(document.querySelectorAll('[itemtype=\"http://schema.org/WebPageElement\"]'))\n\t\t\t\t\t\t.last();\n\n\t\t\t\t\tconsole.log(test.length);\n\t\t\t\t}\n\t\t\t);\n\t\t*/\n\n\t\t/*\n\t\tdemand('/nucleus/support/method')\n\t\t\t.then(\n\t\t\t\tfunction(supportMethod) {\n\t\t\t\t\tdemand(supportMethod('matchMedia', true) || '/nucleus/polyfill/window/matchmedia')\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\tfunction(matchMedia) {\n\t\t\t\t\t\t\t\tconsole.log('here', matchMedia);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t*/\n\n\t\t/*\n\t\tdemand('/nucleus/task')\n\t\t\t.then(\n\t\t\t\tfunction(Task) {\n\t\t\t\t\tnew Task(function() { return +new Date(); }).then(\n\t\t\t\t\t\tfunction(result) {\n\t\t\t\t\t\t\tconsole.log(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t*/\n\n\t\t/*\n\t\tdemand('/nucleus/support/test/element/video/mp4')\n\t\t\t.then(\n\t\t\t\tfunction(supportTestVideoMp4) {\n\t\t\t\t\tsupportTestVideoMp4.then(\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tconsole.log('supports video.mp4');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tconsole.log('no support for video.mp4');\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tfunction(error) {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t}\n\t\t\t);\n\t\t*/\n\n\t\t/*\n\t\tdemand('/nucleus/dom/element')\n\t\t\t.then(function(DomElement) {\n\t\t\t\tvar body  = new DomElement('body'),\n\t\t\t\t\tdebug = new DomElement('<div />', { 'data-test': 'debug' })\n\t\t\t\t\t\t.setContent('debug')\n\t\t\t\t\t\t.appendTo(body);\n\n\t\t\t\tbody\n\t\t\t\t\t.on('click', '[data-test]',\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tconsole.log('click', arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t});\n\t\t*/\n\n\t\t/*\n\t\tdemand('/nucleus/transport/xhr')\n\t\t\t.then(function(transportXhr) {\n\t\t\t\tvar xhr = new transportXhr('//cdn.jsdelivr.net/qoopido.demand/2.0.8/handler/text.js');\n\n\t\t\t\txhr\n\t\t\t\t\t.get()\n\t\t\t\t\t.then(\n\t\t\t\t\t\tfunction(response) {\n\t\t\t\t\t\t\tconsole.log(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t});\n\t\t*/\n\n\t\t/*\n\t\tdemand('/nucleus/dom/element', '/nucleus/dom/collection')\n\t\t\t.then(function(DomElement, DomCollection) {\n\t\t\t\tvar body  = new DomElement('body'),\n\t\t\t\t\ttest  = new DomElement('<div />'),\n\t\t\t\t\tdebug = new DomCollection('[itemtype=\"http://schema.org/WebPageElement\"]');\n\n\t\t\t\ttest\n\t\t\t\t\t.addClass('debug')\n\t\t\t\t\t.setContent('debug')\n\t\t\t\t\t.appendTo(body);\n\n\t\t\t\tbody.on('click', '.debug', function() {\n\t\t\t\t\tconsole.log('debug clicked');\n\t\t\t\t});\n\n\t\t\t\tconsole.log(debug, debug.length);\n\t\t\t});\n\t\t*/\n\n\t\treturn true;\n\t}\n\n\tprovide([ 'demand' ], definition);\n}(this, demand, provide));"],"sourceRoot":"/source/"}